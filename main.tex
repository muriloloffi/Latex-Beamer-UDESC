\documentclass{beamer}

\usepackage{graphicx,hyperref,udesc,url}
\usepackage[latin1]{inputenc}
%\usepackage[T1]{fontenc}
\usepackage{listings}
\usepackage{minted}
\usepackage{booktabs}
\usepackage{bussproofs}
\usepackage[portuges]{babel}

\AtBeginSection[]{
  \begin{frame}
  \vfill
  \centering
  \begin{beamercolorbox}[sep=8pt,center,shadow=true,rounded=true]{title}
    \usebeamerfont{title}\insertsectionhead\par%
  \end{beamercolorbox}
  \vfill
  \end{frame}
}

\title[Sistemas de Tipos]{Sistemas de Tipos}

\author[Rafael Castro]{
    Rafael Castro\\\medskip
    {\small \url{rafaelcgs10@gmail.com}}}

\date{10 de Julho de 2019}

    \institute[UDESC]{
        Departamento de Ci\^encia da Computa\c{c}\~ao \\
            Centro de Ci\^encias e Tecnol\'ogicas\\
            Universidade do Estado de Santa Catarina}

\begin{document}

\begin{frame}
\titlepage

\end{frame}

\begin{frame}[fragile]
\frametitle{Plano de Aula - Sistema de Tipos}
\begin{block}{Objetivos}
  Explicar o que são e para que servem sistemas de tipos na
  Ciência da Computação.
\end{block}
\begin{block}{Conteúdos}
  \begin{itemize}
    \item Sistemas de tipos em linguagens de programação.
    \item Breve visão histórica sobre Teoria de Tipos.
    \item Sistemas de tipos formais em linguagens de programação.
  \end{itemize}
\end{block}
\begin{block}{Método}
  Exposição do conteúdo com exemplos, questionamentos e exercícios.
\end{block}
\end{frame}

\section{Sistemas de tipos em linguagens de programação}
\begin{frame}[fragile]
\frametitle{Questões preliminares}
O que são tipos (em linguagens de programação)?
\pause
\begin{itemize}
  \item Classificações dos dados de um programa: carácter, inteiro, função etc.
\end{itemize}
\pause
Por que linguagens de programação utilizam tipos?
\pause
\begin{columns}
  \begin{column}{0.5\textwidth}
\begin{minted}{c}
void foo() {
  int n = 1;
  char m = '2';
  printf("%d\n", n + m);
}
\end{minted}
\end{column}
\begin{column}{0.5\textwidth}
\begin{minted}{c}
void spam() {
  int n;
  scanf("%d", &n);
  printf("%d\n", n);
  return 0;
}
\end{minted}
\end{column}
\end{columns}
\pause
Os tipos fazem parte da construção semântica dos programas. \\

Existem linguagens de programação sem tipos (\textit{untyped}), como
linguagens assembly, BCPL, Tcl, Brainfuck.

\end{frame}

\begin{frame}[fragile]
\frametitle{Tipagem estática vs dinâmica}
\begin{itemize}
  \item Na tipagem estática a verificação dos tipos é feita em por análise do código durante a compilação.
  \item Na tipagem dinâmica a verificação dos tipos é feita somente na execução.\\ Se uma parte do código com
    erro (de tipo) não for executada, o erro ficará oculto.
\end{itemize}
\pause
\begin{itemize}
  \item Estática: atribuições de tipo não mudam em \textit{run time}.
  \item Dinâmica: atribuições de tipo \textbf{podem mudar} em \textit{run time}.
\end{itemize}
\pause
Exemplos de linguagens de tipagem estática?\\
\pause
C, C++, Java, Rust, Haskell, OCaml...\\
\pause
Exemplos de linguagens de tipagem dinâmica?\\
\pause
Python, PHP, JavaScript, Lisp, Erlang...
\end{frame}

\begin{frame}[fragile]
\frametitle{Vantagens e desvantagens:  estática e dinâmica}
Estática:
\begin{itemize}
  \item Vantagens: Reduz os possíveis erros em tempo de execução; Possibilita algumas otimizações de código
   pelo compilador; Verificação automática; Útil em códigos grandes.
 \item Desvantagens: Mais uma coisa para aprender sobre a linguagem;
   Requerem que tipos sejam explicitados (não todas as linguagens); Podem limitar o reuso de código.
\end{itemize}

Dinâmica:
\begin{itemize}
\item Vantagens: Mais permissível; Mais fácil de aprender; geralmente tem mais interatividade (REPL);
    geralmente suportam \textit{duck typing}.
  \item Desvantagens: Testes são muito mais importantes; abre espaço para erros inesperados em execução;
    geralmente são menos eficientes. 
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\frametitle{Tipagem forte e fraca}
Esse é um conceito meio nebuloso! \\
Não é preto ou branco\\
\begin{itemize}
  \item Forte: as regras de tipagem são rígidas; não há cast de tipos implícitos; os casts de tipos fazem sentido.
  \item Fraca: as regras de tipagem são flexíveis; casts automáticos podem ocorrer.
\end{itemize}
\pause
Em Python:
\begin{minted}{python}
"Dia " + str(1) + " de Janeiro" 
\end{minted}
\pause
Em JavaScript:
\begin{minted}{js}
[] + []; // "" 
[] + 1; // "1" 
{} + {} // NaN 
{} + [] // 0 
\end{minted}
\end{frame}

\section{Breve visão histórica sobre Teoria de Tipos}
\begin{frame}[fragile]
  \frametitle{Visão histórica - Russel}
  \begin{block}{Teoria dos Tipos}
    \begin{columns}
      \begin{column}{0.5\textwidth}
        \begin{itemize}
        \item Bertrand Russell
        \item Teorias de Tipos são uma resposta
          ao paradoxo de Russel presente na \textit{naive set theory}.
        \item Uma teoria alternativa a Teoria dos Conjuntos para uma fundação
          formal da matemática.
        \end{itemize}
      \end{column}
      \begin{column}{0.5\textwidth}
        \begin{center}
          \includegraphics[width=0.8\textwidth]{russel.jpg}
        \end{center}
      \end{column}
    \end{columns}
  \end{block}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Visão histórica - Church}
  \begin{block}{Teoria dos Tipos}
    \begin{columns}
      \begin{column}{0.5\textwidth}
        \begin{itemize}
        \item Alonzo Church
        \item Aplicou a teoria de tipos de Russel no
          modelo de computação chamado Cálculo Lambda, a
          fim de evitar paradoxos e computações sem fim.
        \item Essa junção entre Teoria de Tipos e Cálculo Lambda é o
          fundamento teórico para sistemas de tipos em linguagens de programação.
        \end{itemize}
      \end{column}
      \begin{column}{0.5\textwidth}
        \begin{center}
          \includegraphics[width=0.8\textwidth]{church.jpg}
        \end{center}
      \end{column}
    \end{columns}
  \end{block}
\end{frame}

\section{Sistemas de tipos formais em linguagens de programação}
\begin{frame}[fragile]
\frametitle{Questões preliminares}
O que são tipos (na matemática)? \\
\pause
Tipos são propriedades atribuídas a certas construções/objetos.\\
Ex: 1 tem o tipo natural. \\~\\
\pause
Qual a diferença entre tipos e conjuntos? 
\pause
\begin{itemize}
  \item Teoria dos Tipos é uma teoria matemática sobre construções.
  \item Teoria dos Conjuntos é uma teoria matemática sobre coleções. 
\end{itemize}
.
\pause
\\O que são sistemas de tipos (formais)? \\
\pause
Sistemas de tipos são relações que ditam quais expressões/construções podem ser
associadas a quais tipos. \\~\\
\pause
Por que definir sistemas de tipos formalmente?\\
\pause
Para garantir boas propriedades semânticas de programas. \\
Ex: Evita que você crie JavaScript.
\end{frame}

\begin{frame}[fragile]
\frametitle{Exemplo básico de sistema de tipo formal}
\large{A linguagem de programação:}\\~\\
Gramática informal dos programas:
\begin{align*}
  e := x \:|\: \lambda x. e \: | \: e\:e' 
\end{align*}
Gramática informal dos tipos:
\begin{align*}
  \tau := \alpha \:|\: \tau \rightarrow \tau' 
\end{align*}
Exemplos de programas:
\begin{align*}
  x \\
  x\:y \\
  \lambda x. x \\
  (\lambda x. x)\: y\\
  \lambda x. \lambda y. \lambda z. y
\end{align*}
\end{frame}

\begin{frame}[fragile]
\frametitle{Exemplo básico de sistema de tipo formal}
Relação de tipagem:
\begin{center}
        \begin{prooftree}
            \AxiomC{}
            \RightLabel{$(var)$}
            \UnaryInfC{$x:\tau, \Gamma \vdash x: \tau$}
        \end{prooftree}
\end{center}
\begin{center}
\begin{minipage}{.55\textwidth}
        \begin{prooftree}
            \AxiomC{$\Gamma \vdash e : \tau \rightarrow \tau'$}
            \AxiomC{$\Gamma \vdash e' : \tau$}
            \RightLabel{$(abs)$}
            \BinaryInfC{$\Gamma \vdash e \: e' :\tau'$}
        \end{prooftree}
\end{minipage}
\begin{minipage}{.3\textwidth}
        \begin{prooftree}
            \AxiomC{$x:\tau, \Gamma \vdash e:\tau'$}
            \RightLabel{$(app)$}
            \UnaryInfC{$\Gamma \vdash \lambda x. e : \tau \rightarrow \tau'$}
        \end{prooftree}
\end{minipage}
\end{center}
\pause
Exemplos de tipagem:
\begin{center}
\begin{minipage}{.43\textwidth}
\begin{prooftree}
    \AxiomC{$x:a \vdash x:a$}
    \RightLabel{$(abs)$}
    \UnaryInfC{$ \vdash \lambda x . x:{a \rightarrow a}$}
\end{prooftree}
\end{minipage}
\begin{minipage}{.47\textwidth}
  \begin{prooftree}
    \AxiomC{$y:b \vdash y:b$}
    \RightLabel{$(abs)$}
    \UnaryInfC{$ y:b \vdash \lambda z . y:a \rightarrow b$}
    \RightLabel{$(abs)$}
    \UnaryInfC{$\vdash \lambda y.  \lambda z . y:b \rightarrow a \rightarrow b$}
    \RightLabel{$(abs)$}
    \UnaryInfC{$\vdash \lambda x. \lambda y . \lambda z . y: c \rightarrow b \rightarrow a \rightarrow b$}
\end{prooftree}
\end{minipage}
\end{center}
\end{frame}

\begin{frame}[fragile]
\frametitle{Exercício sobre tipagem}
Construa a árvore de tipagem para a expressão
\begin{align*}
  (\lambda x.x)(\lambda x.x) \\
\end{align*}
\end{frame}


\begin{frame}[fragile]
\frametitle{Linguagens de programação baseados em sistemas de tipos formais}
A mais importante propriedade semântica que um sistema de tipos pode garantir para
uma linguagem de programação é \textit{type soundness}.\\~\\
Também chamado informalmente de \textit{type safety}. \\~\\
Significa que erros de tipo não acontecem em programas bem-tipados. \\~\\

ML é uma linguagem de programação funcional com a propriedade de \textit{type soundness}. \\

\end{frame}


\begin{frame}[fragile]
\frametitle{Resposta do Exercício}
\begin{prooftree}
    \AxiomC{$x:a \rightarrow a \vdash x:a \rightarrow a$}
    \RightLabel{$(abs)$}
    \UnaryInfC{$ \vdash (\lambda x . x):{(a \rightarrow a) \rightarrow (a \rightarrow a)}$}
    \RightLabel{$(abs)$}
    \AxiomC{$x:a \vdash x:a$}
    \UnaryInfC{$ \vdash (\lambda x . x):{a \rightarrow a}$}
    \RightLabel{$(app)$}
    \BinaryInfC{$\vdash (\lambda x.x)(\lambda x.x) : a \rightarrow a$}
\end{prooftree}

\end{frame}

\begin{frame}[fragile]
\frametitle{Conclusão}
Dúvidas? \\~\\

Nesta aula foi apresentado:
\begin{itemize}
  \item O que são e para que servem sistemas de tipos em linguagens de programação.
  \item O que são e para que servem sistemas de tipos \textit{formais} em linguagens de programação.
\end{itemize}
\end{frame}

\end{document}
%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
